(self.webpackChunkvue_el_demo=self.webpackChunkvue_el_demo||[]).push([["840"],{26058:function(t,e,s){var a={"./af":"42786","./af.js":"42786","./ar":"30867","./ar-dz":"14130","./ar-dz.js":"14130","./ar-kw":"96135","./ar-kw.js":"96135","./ar-ly":"56440","./ar-ly.js":"56440","./ar-ma":"47702","./ar-ma.js":"47702","./ar-ps":"20315","./ar-ps.js":"20315","./ar-sa":"16040","./ar-sa.js":"16040","./ar-tn":"37100","./ar-tn.js":"37100","./ar.js":"30867","./az":"31083","./az.js":"31083","./be":"9808","./be.js":"9808","./bg":"68338","./bg.js":"68338","./bm":"67438","./bm.js":"67438","./bn":"8905","./bn-bd":"76225","./bn-bd.js":"76225","./bn.js":"8905","./bo":"11560","./bo.js":"11560","./br":"1278","./br.js":"1278","./bs":"80622","./bs.js":"80622","./ca":"2468","./ca.js":"2468","./cs":"5822","./cs.js":"5822","./cv":"50877","./cv.js":"50877","./cy":"47373","./cy.js":"47373","./da":"24780","./da.js":"24780","./de":"59740","./de-at":"60217","./de-at.js":"60217","./de-ch":"60894","./de-ch.js":"60894","./de.js":"59740","./dv":"5300","./dv.js":"5300","./el":"50837","./el.js":"50837","./en-au":"78348","./en-au.js":"78348","./en-ca":"77925","./en-ca.js":"77925","./en-gb":"22243","./en-gb.js":"22243","./en-ie":"46436","./en-ie.js":"46436","./en-il":"47207","./en-il.js":"47207","./en-in":"44175","./en-in.js":"44175","./en-nz":"76319","./en-nz.js":"76319","./en-sg":"31662","./en-sg.js":"31662","./eo":"92915","./eo.js":"92915","./es":"55655","./es-do":"55251","./es-do.js":"55251","./es-mx":"96112","./es-mx.js":"96112","./es-us":"71146","./es-us.js":"71146","./es.js":"55655","./et":"5603","./et.js":"5603","./eu":"77763","./eu.js":"77763","./fa":"76959","./fa.js":"76959","./fi":"11897","./fi.js":"11897","./fil":"42549","./fil.js":"42549","./fo":"94694","./fo.js":"94694","./fr":"94470","./fr-ca":"63049","./fr-ca.js":"63049","./fr-ch":"52330","./fr-ch.js":"52330","./fr.js":"94470","./fy":"5044","./fy.js":"5044","./ga":"29295","./ga.js":"29295","./gd":"2101","./gd.js":"2101","./gl":"38794","./gl.js":"38794","./gom-deva":"27884","./gom-deva.js":"27884","./gom-latn":"23168","./gom-latn.js":"23168","./gu":"95349","./gu.js":"95349","./he":"24206","./he.js":"24206","./hi":"30094","./hi.js":"30094","./hr":"30316","./hr.js":"30316","./hu":"22138","./hu.js":"22138","./hy-am":"11423","./hy-am.js":"11423","./id":"29218","./id.js":"29218","./is":"90135","./is.js":"90135","./it":"90626","./it-ch":"10150","./it-ch.js":"10150","./it.js":"90626","./ja":"39183","./ja.js":"39183","./jv":"24286","./jv.js":"24286","./ka":"12105","./ka.js":"12105","./kk":"47772","./kk.js":"47772","./km":"18758","./km.js":"18758","./kn":"79282","./kn.js":"79282","./ko":"33730","./ko.js":"33730","./ku":"1408","./ku-kmr":"90563","./ku-kmr.js":"90563","./ku.js":"1408","./ky":"33291","./ky.js":"33291","./lb":"36841","./lb.js":"36841","./lo":"55466","./lo.js":"55466","./lt":"57010","./lt.js":"57010","./lv":"37595","./lv.js":"37595","./me":"39861","./me.js":"39861","./mi":"35493","./mi.js":"35493","./mk":"95966","./mk.js":"95966","./ml":"87341","./ml.js":"87341","./mn":"5115","./mn.js":"5115","./mr":"10370","./mr.js":"10370","./ms":"9847","./ms-my":"41237","./ms-my.js":"41237","./ms.js":"9847","./mt":"72126","./mt.js":"72126","./my":"56165","./my.js":"56165","./nb":"64924","./nb.js":"64924","./ne":"16744","./ne.js":"16744","./nl":"93901","./nl-be":"59814","./nl-be.js":"59814","./nl.js":"93901","./nn":"83877","./nn.js":"83877","./oc-lnc":"92135","./oc-lnc.js":"92135","./pa-in":"15858","./pa-in.js":"15858","./pl":"64495","./pl.js":"64495","./pt":"89520","./pt-br":"57971","./pt-br.js":"57971","./pt.js":"89520","./ro":"96459","./ro.js":"96459","./ru":"21793","./ru.js":"21793","./sd":"40950","./sd.js":"40950","./se":"10490","./se.js":"10490","./si":"90124","./si.js":"90124","./sk":"64249","./sk.js":"64249","./sl":"14985","./sl.js":"14985","./sq":"51104","./sq.js":"51104","./sr":"49131","./sr-cyrl":"79915","./sr-cyrl.js":"79915","./sr.js":"49131","./ss":"85893","./ss.js":"85893","./sv":"98760","./sv.js":"98760","./sw":"91172","./sw.js":"91172","./ta":"27333","./ta.js":"27333","./te":"23110","./te.js":"23110","./tet":"52095","./tet.js":"52095","./tg":"27321","./tg.js":"27321","./th":"9041","./th.js":"9041","./tk":"19005","./tk.js":"19005","./tl-ph":"75768","./tl-ph.js":"75768","./tlh":"89444","./tlh.js":"89444","./tr":"72397","./tr.js":"72397","./tzl":"28254","./tzl.js":"28254","./tzm":"51106","./tzm-latn":"30699","./tzm-latn.js":"30699","./tzm.js":"51106","./ug-cn":"9288","./ug-cn.js":"9288","./uk":"67691","./uk.js":"67691","./ur":"13795","./ur.js":"13795","./uz":"6791","./uz-latn":"60588","./uz-latn.js":"60588","./uz.js":"6791","./vi":"65666","./vi.js":"65666","./x-pseudo":"14378","./x-pseudo.js":"14378","./yo":"75805","./yo.js":"75805","./zh-cn":"83839","./zh-cn.js":"83839","./zh-hk":"55726","./zh-hk.js":"55726","./zh-mo":"99807","./zh-mo.js":"99807","./zh-tw":"74152","./zh-tw.js":"74152"};function i(t){return s(o(t))}function o(t){if(!s.o(a,t)){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=o,t.exports=i,i.id=26058},94147:function(t,e,s){"use strict";s.d(e,{Z:function(){return a}});var a=(0,s(51900).Z)({name:"AsideToggler",props:{isCollapse:{type:Boolean,default:!1},tooltip:{type:String,default:""},activeTooltip:{type:String,default:""},inactiveTooltip:{type:String,default:""},position:{type:String,default:"left"},minWidth:{type:Number,default:200},maxWidth:{type:Number,default:600},dragElementClass:{type:String,default:""}},data:()=>({tooltipVisible:!0,dragElement:void 0}),computed:{tooltipContent(){let t=this.activeTooltip||`\u{6536}\u{8D77}${this.tooltip}`,e=this.inactiveTooltip||`\u{5C55}\u{5F00}${this.tooltip}`;return this.isCollapse?e:t},iconClass(){return{"aside-toggler-icon":!0,"el-icon-caret-left":!this.isCollapse,"el-icon-caret-right":this.isCollapse}}},watch:{position(t){this.tooltipVisible=!1,this.$nextTick(()=>{this.tooltipVisible=!0})}},mounted(){this.$nextTick(()=>{this.dragElementClass&&(this.dragElement=this.$parent.$el.getElementsByClassName(this.dragElementClass)[0])})},methods:{toggle(t){t.stopPropagation(),this.$emit("update:isCollapse",!this.isCollapse),this.$emit("toggle",!this.isCollapse)},dragEvent(t){if(t.stopPropagation(),this.isCollapse||!this.dragElement)return;let e=t.clientX,s=this.dragElement.offsetWidth;document.onmousemove=t=>{let a="left"===this.position?s+(t.clientX-e):s-(t.clientX-e);this.dragElement.style.width=`clamp(${this.minWidth}px, ${a}px, ${this.maxWidth}px)`;let i="col-resize";a<=this.minWidth?i="left"===this.position?"e-resize":"w-resize":a>=this.maxWidth&&(i="left"===this.position?"w-resize":"e-resize"),document.body.style.cursor=i},document.onmouseup=t=>{document.onmousemove=null,document.onmouseup=null,document.body.style.cursor=""}}}},function(){var t=this._self._c;return t("div",{staticClass:"aside-toggler-container",attrs:{"data-position":this.position},on:{mousedown:this.dragEvent}},[!this.isCollapse&&this.dragElement?t("div",{staticClass:"resize-bar"}):this._e(),this.tooltipVisible?t("el-tooltip",{attrs:{effect:"dark",content:this.tooltipContent,placement:"right"===this.position?"left":"right"}},[t("div",{staticClass:"aside-toggler",on:{click:this.toggle}},[t("i",{class:this.iconClass})])]):this._e()],1)},[],!1,null,"4ba6c4c1",null).exports},48918:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return a}});var a=(0,s(51900).Z)({name:"ExampleWidget",widget:{name:"便利贴",icon:"el-icon-postcard",params:{content:""},disabled:!1,hidden:!1,w:8,h:3,minW:8,minH:3,maxW:24,maxH:6,isResizable:!0},inject:["$dashboard"],props:{item:{type:Object,default:()=>({})},params:{type:Object,default:()=>({})}},data:()=>({formVisible:!1,form:{content:""},rules:{content:[{required:!0,message:"请输入便利贴内容",trigger:"change"}]}}),watch:{"$dashboard.isCollapse"(t){t&&(this.formVisible=!1)},"params.content"(t){this.form.content=t}},mounted(){this.form={...this.params}},refresh(t){},setting(t){this.formVisible=!0},move(t,e,s,a){},moved(t,e,s,a){},resize(t,e,s,a,i,o){},resized(t,e,s,a,i,o){},containerResized(t,e,s,a,i,o){},methods:{save(){this.$refs.form.validate(t=>{t&&(this.formVisible=!1,this.$emit("update:params",{...this.form}),this.$dashboard.notify("便利贴保存成功！"))})}}},function(){var t=this,e=t._self._c;return e("el-card",[e("span",{staticClass:"note-content"},[t._v(t._s(t.params.content))]),e("el-popover",{attrs:{trigger:"manual","popper-class":"form-popover"},model:{value:t.formVisible,callback:function(e){t.formVisible=e},expression:"formVisible"}},[e("el-form",{ref:"form",attrs:{"label-width":"80px","label-position":"top",model:t.form,rules:t.rules}},[e("el-form-item",{attrs:{label:"便利贴",prop:"content"}},[e("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),e("div",{staticClass:"text-right"},[e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){t.formVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.save}},[t._v("保存")])],1)],1)],1)},[],!1,null,"6c40ed08",null).exports},17777:function(t,e,s){"use strict";s.d(e,{Z:function(){return n}});var a,i,o={name:"FullScreenToggler",directives:{fullscreen:s(48651).directive},props:{target:{type:String,default:"document.body"},bodyAgent:{type:Boolean,default:!0},fullscreenClass:{type:String,default:"is-fullscreen"},pageOnly:{type:Boolean,default:!1},teleport:{type:Boolean,default:!1}},data:()=>({isFullscreen:!1}),computed:{options(){return{target:this.bodyAgent?"document.body":this.target,callback:t=>{this.isFullscreen=t,this.bodyAgent&&"document.body"!==this.target&&document.querySelector(this.target).classList.toggle("is-fullscreen-fullpage",t),this.$emit("change",t)},fullscreenClass:this.fullscreenClass}}},render(t){return t("span",{class:"full-screen-toggler",attrs:{title:this.isFullscreen?"退出全屏":"全屏"},directives:[{name:"fullscreen",value:this.options,modifiers:{pageOnly:this.pageOnly,teleport:this.teleport}}]},[t("SvgIcon",{props:{iconClass:this.isFullscreen?"exit-fullscreen":"fullscreen"}})])}},n=(0,s(51900).Z)(o,a,i,!1,null,"a9ac93f8",null).exports},62355:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return k}});var a,i,o=s(77502),n=s(51900),r=(0,n.Z)({name:"DashboardEditDialog",inject:["$dashboard"],data(){return{dialogVisible:!1,type:"new",loading:!1,form:{id:0,route:this.$route.name,name:"",layout:null,aside:"right",compact:!0},rules:{name:[{required:!0,message:"请输入仪表盘名称",trigger:"change"},{max:20,message:"名称不能超过 20 个字符",trigger:"change"}]}}},computed:{dialogTitle(){return"edit"===this.type?"编辑仪表盘":"copy"===this.type?"复制仪表盘":"新建仪表盘"},postData(){return{...this.form,layout:JSON.stringify(this.form.layout)}}},methods:{show(t,e){this.type=t,"new"!==t&&(this.form={...this.form,...e,id:"edit"===t?e.id:0}),this.dialogVisible=!0},save(){this.$refs.form.validate(t=>{t&&this.submit()})},submit(){this.form.id,this.loading=!0}}},function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.dialogTitle,"custom-class":"dashboard-edit-dialog",visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"96px","label-position":"left"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"请输入名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"紧凑布局",prop:"compact",required:""},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",[t._v("紧凑布局")]),e("el-tooltip",{attrs:{content:"紧凑布局时，会压缩组件垂直间距",placement:"bottom-start","open-delay":500,offset:-10}},[e("i",{staticClass:"el-icon-question"})])]},proxy:!0}])},[e("el-switch",{model:{value:t.form.compact,callback:function(e){t.$set(t.form,"compact",e)},expression:"form.compact"}})],1)],1),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"侧栏位置",prop:"aside",required:""}},[e("el-radio-group",{model:{value:t.form.aside,callback:function(e){t.$set(t.form,"aside",e)},expression:"form.aside"}},[e("el-radio",{attrs:{label:"left"}},[t._v("左侧")]),e("el-radio",{attrs:{label:"right"}},[t._v("右侧")])],1)],1)],1)],1),e("el-form-item",{staticStyle:{display:"none"},attrs:{prop:"id"}}),e("el-form-item",{staticStyle:{display:"none"},attrs:{prop:"route"}}),e("el-form-item",{staticStyle:{display:"none"},attrs:{prop:"layout"}})],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{icon:"el-icon-close",size:"medium"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"medium"},on:{click:t.save}},[t._v("确 定")])],1)],1)},[],!1,null,null,null).exports,l=s(94147),d=s(17777),c=s(20144),m=s(20629),u=[{element:".dashboard-operations:last-child",popover:{title:"展开组件列表",description:"点击管理组件按钮展开侧栏组件列表",showButtons:["next","close"]}},{element:".dashboard-container .dashboard-aside",popover:{title:"添加组件",description:`\u{70B9}\u{51FB}\u{7EC4}\u{4EF6}\u{7684}\u{6DFB}\u{52A0}\u{6309}\u{94AE}
        <button type="button" class="el-button el-button--default el-button--mini is-circle">
          <i class="el-icon-plus"></i>
        </button>
        \u{6216}\u{8005}\u{62D6}\u{62FD}\u{7EC4}\u{4EF6}\u{653E}\u{7F6E}\u{5230}\u{5BB9}\u{5668}\u{4E2D}\u{5373}\u{53EF}\u{3002}`}},{element:".dashboard-container .dashboard-main",popover:{title:"改变位置",description:'鼠标 <i class="el-icon-rank" /> 按住组件即可拖拽调整组件位置。'}},{element:".dashboard-container .vue-grid-item:first-child",popover:{title:"调整大小",description:'鼠标移动到组件右下角，鼠标会变成可调整大小的图标 <i class="el-icon-bottom-right"></i>，此时按住鼠标左键即可调整组件大小。',align:"end"}},{element:".dashboard-container .vue-grid-item:first-child",popover:{title:"配置组件",description:`\u{9F20}\u{6807}\u{79FB}\u{52A8}\u{5230}\u{7EC4}\u{4EF6}\u{4E0A}\u{FF0C}\u{7EC4}\u{4EF6}\u{53F3}\u{4E0A}\u{89D2}\u{4F1A}\u{51FA}\u{73B0}\u{64CD}\u{4F5C}\u{6309}\u{94AE}\u{7EC4}
        <div class="el-button-group">
          <button type="button" class="el-button el-button--success el-button--medium" title="\u{5237}\u{65B0}\u{7EC4}\u{4EF6}" style="padding: 2px 4px;">
            <i class="el-icon-refresh"></i>
          </button>
          <button type="button" class="el-button el-button--primary el-button--medium" title="\u{914D}\u{7F6E}\u{7EC4}\u{4EF6}" style="padding: 2px 4px;">
            <i class="el-icon-setting"></i>
          </button>
          <button type="button" class="el-button el-button--danger el-button--medium" title="\u{5220}\u{9664}\u{7EC4}\u{4EF6}" style="padding: 2px 4px;">
            <i class="el-icon-close"></i>
          </button>
        </div>\u{3002}`,align:"start"}},{element:".dashboard-container",popover:{title:"侧栏位置",description:"鼠标按住侧栏任意空白处，拖拽侧栏到页面左侧或右侧然后放下即可改变侧栏位置。"}},{element:".dashboard-operations:last-child",popover:{title:"更多操作",description:'鼠标移动到图标上 <i class="el-icon-arrow-down"></i> 时，会出现紧凑布局开关、刷新、清空等更多操作，点击最右侧按钮可全屏显示。'}},{element:".dashboard-container .dashboard-aside .dashboard-close-btn",popover:{title:"恭喜完成 \uD83C\uDF89",description:"现在你可以尝试自定义一个仪表盘啦！",showButtons:["next"]}}],h=s(64e3);function p(t){let e=[];return t.keys().forEach(s=>{let a=t(s);(a=a.default||a).name&&a.widget?.disabled!==!0&&(c.default.component(a.name,a),e.push(a))}),e}s(5079);let g=p(s(3120));var b={name:"DashboardTemplate",components:{GridLayout:o.GridLayout,GridItem:o.GridItem,DialogEdit:r,AsideToggler:l.Z,FullScreenToggler:d.Z},provide(){return{$dashboard:this}},data(){return{componentsList:[{category:"通用",components:g}],isCollapse:!0,colNum:24,rowHeight:40,gaps:[8,8],dashboardGrid:null,dashboardList:[],dashboard:{id:0,route:this.$route.name,name:"默认仪表盘",layout:[],aside:"right",compact:!1,isDefault:!0},responsive:!1,loading:!1,defaultLayout:[],hasEditPermission:!0,selectedCategory:"全部",menuCollapse:!1}},computed:{...(0,m.Se)("dashboard",["getSelectedDashboardId"]),selectedDashboardId(){return this.getSelectedDashboardId(this.$route.name)},components(){return this.componentsList.reduce((t,e)=>t.concat(e.components),[])},componentsListAvailable(){let t=JSON.parse(JSON.stringify(this.componentsList));return t.forEach(t=>{t.components=t.components.filter(t=>!t.widget.hidden)}),t.unshift({category:"全部",components:t.reduce((t,e)=>t.concat(e.components.map(t=>({...t,category:e.category}))),[])}),t.filter(t=>t.components.length)},componentsByCategory(){return this.componentsListAvailable.find(t=>t.category===this.selectedCategory)?.components||[]}},watch:{"dashboard.isDefault"(t){this.hasEditPermission=!t}},mounted(){this.getDashboard(),this.dashboardGrid=document.querySelector(".dashboard-main .vue-grid-layout"),this.dashboardGrid.addEventListener("dragover",this.onDragoverDashboard),this.dashboardGrid.addEventListener("drop",this.onDropDashboard)},beforeDestroy(){this.dashboardGrid.removeEventListener("dragover",this.onDragoverDashboard),this.dashboardGrid.removeEventListener("drop",this.onDropDashboard)},errorCaptured(t){this.loading=!1,this.notify(t.message,"error")},methods:{notify(t,e="success"){this.$notify.closeAll(),this.$notify({title:t,position:`bottom-${this.dashboard.aside}`,type:e,duration:2e3})},addComponents(t,e,s=!1){if(s)return void this.componentsList.unshift({category:t,components:e});this.componentsList.push({category:t,components:e})},selectCategory(t){this.selectedCategory=t,document.querySelector(".dashboard-container .dashboard-widgets").scrollTop=0},switchDashboard(t){switch(t){case"new":this.$refs.dialogEdit.show("new");break;case this.dashboard.id:break;default:this.loading=!0,this.dashboard=this.dashboardList.find(e=>e.id===t),this.$store.dispatch("dashboard/setSelected",this.dashboard),this.loading=!1}},handleCommand(t){switch(t){case"copy":case"edit":this.removeItem("dropping",!1),this.$refs.dialogEdit.show(t,this.dashboard);break;case"delete":this.deleteDashboard()}},guide(){let t=(0,h.v)({popoverClass:"driverjs-theme",showProgress:!1,prevBtnText:"上一步",nextBtnText:"下一步",doneBtnText:"我知道了",onNextClick:(e,s,a)=>{switch(a.state.activeIndex){case 0:this.isCollapse=!1;break;case 1:0===this.dashboard.layout.length&&this.addItem("ExampleWidget",{params:{content:"Hello World!"},w:8,h:3,minW:8,minH:3,maxW:24,maxH:6,isResizable:!0})}setTimeout(()=>t.moveNext(),0)},onDestroyed:()=>{this.isCollapse=!0,this.saveDashboard()},steps:u});t.drive()},refreshAllItems(){this.notify("正在刷新组件数据 ...","info"),this.$refs.dashboardItem.forEach(t=>{t.$options?.refresh?.call(t)})},clearLayout(){this.dashboard.layout.length&&this.$confirm("确定要清空布局吗？","请确定",{dangerouslyUseHTMLString:!0,cancelButtonClass:"el-icon-close",confirmButtonClass:"el-icon-check",type:"danger"}).then(()=>{this.dashboard.layout=[],this.saveDashboard()}).catch(()=>{})},idIncrement(){return 0===this.dashboard.layout.length?0:this.dashboard.layout.reduce((t,e)=>e.i>t?e.i:t,0)+1},sortItems(){this.dashboard.layout.sort((t,e)=>t.y-e.y||t.x-e.x)},addItem(t,e){if(0===this.dashboard.layout.length)return void this.dashboard.layout.push({i:0,x:0,y:0,component:t,...e});this.sortItems();let s=this.dashboard.layout[this.dashboard.layout.length-1],a=s.x+s.w+e.w>this.colNum;this.dashboard.layout.push({i:this.idIncrement(),x:a?0:s.x+s.w,y:a?s.y+s.h:s.y,component:t,...e}),this.saveDashboard()},removeItem(t,e=!0){this.dashboard.layout=this.dashboard.layout.filter(e=>e.i!==t),"dropping"!==t&&e&&this.saveDashboard()},confirmRemoveItem(t){this.$confirm("确定要删除该组件吗？","删除组件",{cancelButtonClass:"el-icon-close",confirmButtonClass:"el-icon-check",type:"warning"}).then(()=>{this.removeItem(t)}).catch(()=>{})},hasHook(t,e){let s=this.components.find(e=>e.name===t);return s?.[e]&&"function"==typeof s[e]},triggerHook(t,e,s=[],a=!1){if("dropping"===t.i)return;let i=this.$refs.dashboardItem.find(e=>e.$attrs["data-id"]===t.i);i&&i.$options?.[e]?.call(i,t,...s),a&&this.saveDashboard()},mouseInGrid(t,e){let s=this.dashboardGrid.getBoundingClientRect(),a=e-this.dashboardGrid.parentNode.scrollTop;return t>=s.left&&t<=s.right&&a>=s.top&&a<=s.bottom},removeUnExistItems(t){let e=t.map(t=>t.component),s=this.components.map(t=>t.name),a=e.filter(t=>!s.includes(t));return t.filter(t=>!a.includes(t.component))},dragStart(t){t.dataTransfer.setData("text/plain",t.target.dataset.from),"dashboard-aside"===t.target.dataset.from&&(t.dataTransfer.effectAllowed="link"),this.dashboardGrid.classList.add("dragging")},dragEnd(t){this.dashboardGrid.classList.remove("dragging")},drag(t,e,s){if(this.mousePosition&&this.mousePosition.x===s.x&&this.mousePosition.y===s.y)return;let a=this.dashboardGrid.getBoundingClientRect();this.mousePosition={x:s.x,y:s.y};let i=this.mouseInGrid(this.mousePosition.x,this.mousePosition.y),o=this.$refs.gridLayout.$children[0].calcXY(this.mousePosition.y-a.y-this.rowHeight*e.h/2,this.mousePosition.x-a.x-this.$refs.gridLayout.$children[0].calcColWidth()*e.w/2);if(i&&-1===this.dashboard.layout.findIndex(t=>"dropping"===t.i)&&this.dashboard.layout.push({i:"dropping",component:t,...o,...e}),-1!==this.dashboard.layout.findIndex(t=>"dropping"===t.i)){if(i)return void this.$refs.gridLayout.dragEvent("dragstart","dropping",o.x,o.y,e.h,e.w);this.$refs.gridLayout.dragEvent("dragend","dropping"),this.removeItem("dropping",!1)}},onDragoverDashboard(t){t.preventDefault()},onDropDashboard(t){let e=t.dataTransfer.getData("text/plain");if("dashboard-widget"===e){this.$refs.gridLayout.dragEvent("dragend","dropping");let t=this.dashboard.layout.find(t=>"dropping"===t.i);t&&(t.i=this.idIncrement()),this.saveDashboard();return}if("dashboard-aside"===e){let e=document.querySelector(".dashboard-container").getBoundingClientRect(),s=t.x-e.x<e.width/2?"left":"right";s!==this.dashboard.aside&&(this.dashboard.aside=s,this.saveDashboard(),this.notify(`\u{7EC4}\u{4EF6}\u{5217}\u{8868}\u{5DF2}\u{79FB}\u{52A8}\u{5230}${"left"===s?"左":"右"}\u{4FA7}`))}},getDashboard(){this.loading=!0,this.dashboard.layout=this.removeUnExistItems(this.defaultLayout),this.dashboardList.push(this.dashboard),this.loading=!1},saveDashboard(){this.removeItem("dropping",!1),this.dashboard.id?this.updateDashboard():this.addDashboard()},addDashboard(){},updateDashboard(){},deleteDashboard(){this.$confirm(`\u{786E}\u{5B9A}\u{8981}\u{5220}\u{9664}\u{4EEA}\u{8868}\u{76D8} <code>${this.dashboard.name}</code> \u{5417}\u{FF1F}`,"删除仪表盘",{dangerouslyUseHTMLString:!0,cancelButtonClass:"el-icon-close",confirmButtonClass:"el-icon-check",type:"warning"}).then(()=>{}).catch(()=>{})}}},f=(0,n.Z)(b,function(){var t=this,e=t._self._c;return e("div",[e("header",{staticClass:"page-header"},[e("div",{staticClass:"dashboard-operations"},[e("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{command:t.switchDashboard}},[e("span",{staticClass:"el-dropdown-link"},[t._v(" "+t._s(t.dashboard.name)),e("i",{staticClass:"dashboard-operation-icon el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t._l(t.dashboardList,function(s){return e("el-dropdown-item",{key:s.id,attrs:{icon:"el-icon-odometer",command:s.id}},[t._v(" "+t._s(s.name)+" ")])}),e("el-dropdown-item",{attrs:{disabled:t.loading,icon:"el-icon-circle-plus-outline",command:"new",divided:""}},[t._v(" 新建仪表盘 ")])],2)],1),e("el-divider",{attrs:{direction:"vertical"}}),e("el-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:t.handleCommand}},[e("i",{staticClass:"dashboard-operation-icon el-icon-s-operation"}),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{disabled:t.loading,icon:"el-icon-copy-document",command:"copy"}},[t._v(" 复制 ")]),e("el-dropdown-item",{attrs:{disabled:!t.hasEditPermission||t.loading,icon:"el-icon-edit",command:"edit"}},[t._v(" 编辑 ")]),e("el-dropdown-item",{attrs:{disabled:t.dashboard.isDefault||1===t.dashboardList.length||t.loading,icon:"el-icon-delete",command:"delete"}},[t._v(" 删除 ")])],1)],1),e("el-divider",{attrs:{direction:"vertical"}}),e("el-tag",{attrs:{type:"primary",size:"small"}},[t._v(t._s(t.dashboard.isDefault?"全员可见":"组织可见"))])],1),e("div",{staticClass:"dashboard-operations"},[t.hasEditPermission?e("el-dropdown",{attrs:{disabled:t.loading,"split-button":"",type:"primary",placement:"bottom",trigger:"hover",size:"small"},on:{click:function(e){t.isCollapse=!t.isCollapse}}},[e("i",{staticClass:"el-icon-postcard"}),t._v(" 管理组件 "),e("el-dropdown-menu",{staticClass:"dashboard-operation-menu",attrs:{slot:"dropdown"},slot:"dropdown"},[e("li",{directives:[{name:"show",rawName:"v-show",value:!t.isCollapse,expression:"!isCollapse"}],staticClass:"el-dropdown-menu__item",attrs:{tabindex:"-1"}},[e("el-switch",{attrs:{"active-text":"紧凑布局",disabled:t.loading},on:{change:t.saveDashboard},model:{value:t.dashboard.compact,callback:function(e){t.$set(t.dashboard,"compact",e)},expression:"dashboard.compact"}})],1),e("li",{staticClass:"el-dropdown-menu__item",attrs:{tabindex:"-1"}},[e("el-button",{staticClass:"dashboard-operation-btn",attrs:{type:"success",icon:"el-icon-refresh",disabled:t.loading||0===t.dashboard.layout.length,size:"mini"},on:{click:t.refreshAllItems}},[t._v(" 刷新 ")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isCollapse,expression:"!isCollapse"}],staticClass:"dashboard-operation-btn",attrs:{type:"danger",icon:"el-icon-delete",plain:"",disabled:t.loading||0===t.dashboard.layout.length,size:"mini"},on:{click:t.clearLayout}},[t._v(" 清空 ")])],1),e("li",{staticClass:"el-dropdown-menu__item el-dropdown-menu__item--divided",attrs:{tabindex:"-1"}},[e("el-button",{attrs:{type:"text",icon:"el-icon-guide"},on:{click:t.guide}},[t._v("新手引导")])],1)])],1):e("el-button",{staticClass:"dashboard-operation-btn",attrs:{type:"success",icon:"el-icon-refresh",disabled:t.loading||0===t.dashboard.layout.length,size:"small"},on:{click:t.refreshAllItems}},[t._v(" 刷新 ")]),e("el-divider",{attrs:{direction:"vertical"}}),e("FullScreenToggler",{attrs:{target:".page-container"}})],1)]),e("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"dashboard-container",attrs:{"data-target":".dashboard-main","data-direction":t.dashboard.aside,"data-is-expand":!t.isCollapse}},[e("el-aside",{directives:[{name:"show",rawName:"v-show",value:!t.isCollapse,expression:"!isCollapse"}],ref:"dashboardAside",staticClass:"dashboard-aside",attrs:{width:"auto","data-from":"dashboard-aside",draggable:!t.loading},nativeOn:{dragstart:function(e){return t.dragStart.apply(null,arguments)},dragend:function(e){return t.dragEnd.apply(null,arguments)}}},[e("header",{staticClass:"dashboard-aside-header"},[e("span",[t._v("组件列表")]),e("button",{staticClass:"dashboard-close-btn el-icon-close",attrs:{"aria-label":"Close",title:"关闭"},on:{click:function(e){t.isCollapse=!0}}})]),e("main",{staticClass:"dashboard-aside-main"},[t.componentsList.length>2?e("el-menu",{directives:[{name:"show",rawName:"v-show",value:!t.menuCollapse,expression:"!menuCollapse"}],staticClass:"dashboard-categories",attrs:{"default-active":"全部"},on:{select:t.selectCategory}},t._l(t.componentsListAvailable,function(s){return e("el-menu-item",{key:s.category,attrs:{index:s.category}},[e("span",[t._v(t._s(s.category)+" ("+t._s(s.components.length)+")")])])}),1):t._e(),t.componentsList.length>2?e("AsideToggler",{attrs:{"is-collapse":t.menuCollapse,tooltip:"分类"},on:{"update:isCollapse":function(e){t.menuCollapse=e},"update:is-collapse":function(e){t.menuCollapse=e}}}):t._e(),e("ul",{staticClass:"dashboard-widgets"},[t.componentsByCategory.length?t._l(t.componentsByCategory,function(s){return e("li",{key:s.name,staticClass:"dashboard-widget",attrs:{title:s.widget.name,draggable:!t.loading,unselectable:"on","data-from":"dashboard-widget"},on:{dragstart:function(e){return e.stopPropagation(),t.dragStart.apply(null,arguments)},dragend:function(e){return e.stopPropagation(),t.dragEnd.apply(null,arguments)},drag:function(e){return e.stopPropagation(),t.drag(s.name,s.widget,e)}}},[e("span",{staticClass:"widget-info"},[!s.widget.icon||s.widget.icon.includes("el-icon-")||s.widget.icon.includes("iconfont")?e("i",{staticClass:"widget-icon",class:s.widget.icon||"el-icon-postcard"}):e("SvgIcon",{staticClass:"widget-icon",attrs:{"icon-class":s.widget.icon}}),e("span",{staticClass:"widget-name"},[t._v(t._s(s.widget.name))])],1),e("el-button",{attrs:{icon:"el-icon-plus",circle:"",size:"mini"},on:{click:function(e){return t.addItem(s.name,s.widget)}}}),s.category&&t.componentsList.length>2?e("span",{staticClass:"widget-category"},[t._v(t._s(s.category))]):t._e()],1)}):e("li",{staticClass:"dashboard-widget-empty"},[e("span",{staticClass:"widget-info"},[e("i",{staticClass:"widget-icon el-icon-postcard"}),e("span",{staticClass:"widget-name"},[t._v("暂无组件")])]),e("el-button",{attrs:{icon:"el-icon-plus",circle:"",size:"mini",disabled:""}})],1)],2)],1)]),e("el-main",{staticClass:"dashboard-main"},[e("grid-layout",{ref:"gridLayout",attrs:{layout:t.dashboard.layout,"col-num":t.colNum,"row-height":t.rowHeight,"is-draggable":!t.isCollapse&&!t.loading,"is-resizable":!t.isCollapse&&!t.loading,"is-mirrored":!1,"vertical-compact":t.dashboard.compact,margin:t.gaps,responsive:t.responsive,"use-css-transforms":!0},on:{"update:layout":function(e){return t.$set(t.dashboard,"layout",e)}}},t._l(t.dashboard.layout,function(s){return e("grid-item",{directives:[{name:"show",rawName:"v-show",value:"dropping"!==s.i,expression:"item.i !== 'dropping'"}],key:`${t.dashboard.id}-${s.i}`,attrs:{x:s.x,y:s.y,w:s.w,h:s.h,i:s.i,"min-w":s.minW,"min-h":s.minH,"max-w":s.maxW,"max-h":s.maxH,"is-resizable":!!s.isResizable&&!t.isCollapse},on:{move:function(e){return t.triggerHook(s,"move",arguments)},moved:function(e){return t.triggerHook(s,"moved",arguments,!0)},resize:function(e){return t.triggerHook(s,"resize",arguments)},resized:function(e){return t.triggerHook(s,"resized",arguments,!0)},"container-resized":function(e){return t.triggerHook(s,"containerResized",arguments)}}},["dropping"!==s.i?[e(s.component,{ref:"dashboardItem",refInFor:!0,tag:"component",staticClass:"dashboard-item",attrs:{"aria-label":s.name,"data-id":s.i,item:s,params:s.params},on:{"update:params":[function(e){return t.$set(s,"params",e)},t.saveDashboard]}})]:t._e(),!t.isCollapse||t.hasHook(s.component,"refresh")?e("div",{class:{"item-operation":!0,"el-button-group":(t.hasHook(s.component,"refresh")||t.hasHook(s.component,"setting"))&&!t.isCollapse}},[t.hasHook(s.component,"refresh")?e("el-button",{attrs:{title:"刷新组件",type:"success",icon:"el-icon-refresh"},on:{click:function(e){return t.triggerHook(s,"refresh")}}}):t._e(),t.hasHook(s.component,"setting")&&!t.isCollapse?e("el-button",{attrs:{title:"配置组件",type:"primary",icon:"el-icon-setting"},on:{click:function(e){return t.triggerHook(s,"setting")}}}):t._e(),t.isCollapse?t._e():e("el-button",{attrs:{title:"删除组件",type:"danger",icon:"el-icon-close"},on:{click:function(e){return t.confirmRemoveItem(s.i)}}})],1):t._e()],2)}),1),e("el-empty",{directives:[{name:"show",rawName:"v-show",value:!t.loading&&0===t.dashboard.layout.length,expression:"!loading && dashboard.layout.length === 0"}],staticClass:"dashboard-layout-empty",attrs:{description:t.isCollapse?"请展开组件列表添加组件":"点击添加或拖动组件"}},[e("el-button",{attrs:{type:"text",icon:"el-icon-guide"},on:{click:t.guide}},[t._v("新手引导")])],1)],1)],1),e("DialogEdit",{ref:"dialogEdit",on:{refresh:t.getDashboard}})],1)},[],!1,null,"2a0b3b50",null).exports;let y=p(s(86140)),v=p(s(81067));var k=(0,n.Z)({name:"HomeDashboard",extends:f,data:()=>({defaultLayout:[{i:1,component:"ExampleWidget",x:0,y:0,name:"便利贴",icon:"el-icon-postcard",params:{content:"李绅《悯农二首》\n\n春种一粒粟，秋收万颗子。\n四海无闲田，农夫犹饿死。\n\n锄禾日当午，汗滴禾下土。\n谁知盘中餐，粒粒皆辛苦？"},disabled:!1,hidden:!1,w:12,h:6,minW:8,minH:3,maxW:24,maxH:6,isResizable:!0},{i:2,component:"HitokotoWidget",x:12,y:3,name:"一言",icon:"note",params:{c:["d","h","i","j","k"],min:0,max:30},w:12,h:1,minW:8,maxW:24,maxH:1,isResizable:!0},{i:3,component:"AppTestTypesBarWidget",x:0,y:6,name:"App 稳定性测试类型分布",icon:"h-bar",params:{dateRange:["",""],selected:"all"},w:12,h:8,minW:6,minH:6,maxW:12,maxH:8,isResizable:!0},{i:4,component:"AppActivityRateLiquidWidget",x:12,y:6,name:"App 稳定性测试 Activity 覆盖率",icon:"liquid",params:{appIds:[],dateRange:["",""],selected:"all"},w:12,h:8,minW:6,minH:6,maxW:12,maxH:8,isResizable:!0}]}),created(){this.addComponents("图表",y),this.addComponents("日常",v)}},a,i,!1,null,null,null).exports},20808:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return l}});var a=s(44086),i=s(30381),o=s.n(i);o().locale("zh-cn"),o().defaultFormat="YYYY-MM-DD";let n=o()().format();var r={name:"AppTestTypesBarWidget",widget:{name:"App 稳定性测试类型分布",icon:"h-bar",params:{dateRange:["",""],selected:"all"},w:6,h:6,minW:6,minH:6,maxW:12,maxH:8,isResizable:!0},components:{BarChart:a.Z},inject:["$dashboard"],props:{params:{type:Object,default:()=>({})}},data(){return{title:"App 稳定性测试类型分布",loading:!1,dialogVisible:!1,dateRange:["",""],selected:"all",settingSelected:"all",typeName:{ztest:"智能 Monkey",monkey:"原生 Monkey",manual:"人工测试"},data:[{type:"ztest",value:0},{type:"monkey",value:0},{type:"manual",value:0}],barConfig:{xField:"value",yField:"type",xAxis:!1,yAxis:!1,seriesField:"type",legend:{position:"top-left",marker:{symbol:"square"},itemName:{formatter:t=>this.typeName[t]},itemSpacing:10},barWidthRatio:.5,label:{content:t=>`${t.value}\u{6B21}`},tooltip:{fields:["type","value"],formatter:t=>({title:!1,name:this.typeName[t.type],value:`${t.value}\u{6B21}`})},colorField:"type",color:["#6395FA","#65DAAB","#7566FB"]},pickerOptions:{shortcuts:[{text:"最近 7 天",onClick:t=>{t.$emit("pick",[o()().subtract(7,"days").format(),n]),this.settingSelected="last7"}},{text:"最近 30 天",onClick:t=>{t.$emit("pick",[o()().subtract(30,"days").format(),n]),this.settingSelected="last30"}},{text:"本周",onClick:t=>{t.$emit("pick",[o()().startOf("week").format(),n]),this.settingSelected="week"}},{text:"本月",onClick:t=>{t.$emit("pick",[o()().startOf("month").format(),n]),this.settingSelected="month"}},{text:"最近三个月",onClick:t=>{t.$emit("pick",[o()().subtract(3,"months").format(),n]),this.settingSelected="custom"}}],onPick:()=>{this.settingSelected="custom"},disabledDate:t=>t.getTime()>Date.now()},pickerDropdown:[{text:"不限时间",command:"all"},{text:"最近 7 天",command:"last7"},{text:"最近 30 天",command:"last30"},{text:"本周",command:"week"},{text:"本月",command:"month"},{text:"自定义时间",command:"custom"}]}},watch:{dateRange(t){t&&2===t.length||(this.settingSelected="all")}},mounted(){this.dateRange=[...this.params.dateRange],this.selected=this.params.selected,this.settingSelected=this.params.selected,this.getMonkeyTestTypes()},refresh(){this.getMonkeyTestTypes()},setting(){this.dialogVisible=!0},methods:{getMonkeyTestTypes(){this.loading=!0;let t={startDate:"",endDate:""};for(let e of(this.dateRange&&2===this.dateRange.length&&(t.startDate=this.dateRange[0],t.endDate=this.dateRange[1]),this.loading=!1,this.data))e.value=Math.floor(100*Math.random())},handleCommand(t){switch(t){case"all":this.dateRange=["",""];break;case"last7":this.dateRange=[o()().subtract(7,"days").format(),n];break;case"last30":this.dateRange=[o()().subtract(30,"days").format(),n];break;case"week":this.dateRange=[o()().startOf("week").format(),n];break;case"month":this.dateRange=[o()().startOf("month").format(),n];break;case"custom":this.dialogVisible=!0}"custom"!==t&&this.save(t)},save(t){this.selected=t,this.$dashboard.isCollapse||this.$emit("update:params",{dateRange:this.dateRange,selected:this.selected}),this.getMonkeyTestTypes(),this.dialogVisible=!1}}},l=(0,s(51900).Z)(r,function(){var t=this,e=t._self._c;return e("el-card",[e("div",{staticClass:"chart-header"},[e("span",{staticClass:"chart-title",attrs:{title:t.title}},[t._v(t._s(t.title))]),e("el-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:t.handleCommand}},[e("span",{staticClass:"el-dropdown-link"},[e("span",[t._v(t._s(t.pickerDropdown.find(e=>e.command===t.selected).text))]),e("i",{staticClass:"el-icon-arrow-down"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.pickerDropdown,function(s){return e("el-dropdown-item",{key:s.command,attrs:{command:s.command}},[t._v(" "+t._s(s.text)+" ")])}),1)],1)],1),t.data[0].value||t.data[1].value||t.data[2].value?e("BarChart",t._b({directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"barChart",staticClass:"chart-box",attrs:{data:t.data}},"BarChart",t.barConfig,!1)):e("el-empty",{staticClass:"chart-empty",attrs:{"image-size":120}}),e("el-dialog",{attrs:{title:"选择统计范围","custom-class":"dialog-setting",visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"form",attrs:{"label-position":"top"}},[e("el-form-item",{attrs:{label:"日期范围",prop:""}},[e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",editable:!1},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:function(e){return t.save(t.settingSelected||"custom")}}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"0b20971a",null).exports},12815:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return l}});var a=s(44571),i=s(30381),o=s.n(i);o().locale("zh-cn"),o().defaultFormat="YYYY-MM-DD";let n=o()().format();var r={name:"AppActivityRateLiquidWidget",widget:{name:"App 稳定性测试 Activity 覆盖率",icon:"liquid",params:{appIds:[],dateRange:["",""],selected:"all"},w:6,h:6,minW:6,minH:6,maxW:12,maxH:8,isResizable:!0},components:{LiquidChart:a.Z},inject:["$dashboard"],props:{params:{type:Object,default:()=>({})}},data(){return{title:"App 稳定性测试 Activity 覆盖率",loading:!1,dialogVisible:!1,appIds:[],dateRange:["",""],selected:"all",settingSelected:"all",appListOptions:[],liquidConfig:{percent:0,radius:.9,outline:{border:2,distance:4},statistic:{title:{offsetY:-8,formatter:()=>"平均 Activity 覆盖率",style:({percent:t})=>({fontSize:14,fill:t<.6?"#919191":"white"})},content:{style:({percent:t})=>({fontSize:30,fill:t<.5?"rgba(44, 53, 66, 0.85)":"white"})}},liquidStyle:({percent:t})=>({fill:t>.45?"#5B8FF9":"#FAAD14",stroke:t>.45?"#5B8FF9":"#FAAD14"})},pickerOptions:{shortcuts:[{text:"最近 7 天",onClick:t=>{t.$emit("pick",[o()().subtract(7,"days").format(),n]),this.settingSelected="last7"}},{text:"最近 30 天",onClick:t=>{t.$emit("pick",[o()().subtract(30,"days").format(),n]),this.settingSelected="last30"}},{text:"本周",onClick:t=>{t.$emit("pick",[o()().startOf("week").format(),n]),this.settingSelected="week"}},{text:"本月",onClick:t=>{t.$emit("pick",[o()().startOf("month").format(),n]),this.settingSelected="month"}},{text:"最近三个月",onClick:t=>{t.$emit("pick",[o()().subtract(3,"months").format(),n]),this.settingSelected="custom"}}],onPick:()=>{this.settingSelected="custom"},disabledDate:t=>t.getTime()>Date.now()},pickerDropdown:[{text:"不限时间",command:"all"},{text:"最近 7 天",command:"last7"},{text:"最近 30 天",command:"last30"},{text:"本周",command:"week"},{text:"本月",command:"month"},{text:"自定义时间",command:"custom"}]}},watch:{dateRange(t){t&&2===t.length||(this.settingSelected="all")}},created(){this.getAPPList()},mounted(){this.dateRange=[...this.params.dateRange],this.selected=this.params.selected,this.settingSelected=this.params.selected,this.appIds=this.params.appIds,this.getMonkeyActivityRate()},refresh(){this.getMonkeyActivityRate()},setting(){this.dialogVisible=!0,this.getAPPList()},methods:{getAPPList(){this.appListOptions=[{id:1,name:"咪咕阅读",version:"8.70.1"},{id:2,name:"咪咕阅读",version:"8.71.0"},{id:3,name:"TestCrash",version:"2.0"},{id:4,name:"咪咕阅读",version:"8.72.0"},{id:5,name:"优酷视频",version:"10.2.22"},{id:6,name:"优酷视频",version:"10.2.57"},{id:7,name:"抖音",version:"25.4.0"},{id:8,name:"咪咕阅读",version:"9.5.0"}]},getMonkeyActivityRate(){this.loading=!0;let t={appIds:this.appIds.join(","),startDate:"",endDate:""};this.dateRange&&2===this.dateRange.length&&(t.startDate=this.dateRange[0],t.endDate=this.dateRange[1]),this.loading=!1,this.liquidConfig.percent=Math.random()},handleCommand(t){switch(t){case"all":this.dateRange=["",""];break;case"last7":this.dateRange=[o()().subtract(7,"days").format(),n];break;case"last30":this.dateRange=[o()().subtract(30,"days").format(),n];break;case"week":this.dateRange=[o()().startOf("week").format(),n];break;case"month":this.dateRange=[o()().startOf("month").format(),n];break;case"custom":this.dialogVisible=!0}"custom"!==t&&this.save(t)},save(t){this.selected=t,this.$dashboard.isCollapse||this.$emit("update:params",{appIds:this.appIds,dateRange:this.dateRange,selected:this.selected}),this.getMonkeyActivityRate(),this.dialogVisible=!1}}},l=(0,s(51900).Z)(r,function(){var t=this,e=t._self._c;return e("el-card",[e("div",{staticClass:"chart-header"},[e("span",{staticClass:"chart-title",attrs:{title:t.title}},[t._v(t._s(t.title))]),e("el-dropdown",{attrs:{trigger:"click",placement:"bottom"},on:{command:t.handleCommand}},[e("span",{staticClass:"el-dropdown-link"},[e("span",[t._v(t._s(t.pickerDropdown.find(e=>e.command===t.selected).text))]),e("i",{staticClass:"el-icon-arrow-down"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.pickerDropdown,function(s){return e("el-dropdown-item",{key:s.command,attrs:{command:s.command}},[t._v(" "+t._s(s.text)+" ")])}),1)],1)],1),e("LiquidChart",t._b({directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"liquidChart",staticClass:"chart-box"},"LiquidChart",t.liquidConfig,!1)),e("el-dialog",{attrs:{"custom-class":"dialog-setting",visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"el-dialog__title"},[t._v("配置组件")]),e("small",{staticClass:"text-info"},[t._v(t._s(t.title))])]),e("el-form",{ref:"form",attrs:{"label-position":"top"}},[e("el-form-item",{attrs:{label:"指定APP"}},[e("el-select",{staticStyle:{width:"350px"},attrs:{multiple:"",clearable:"","collapse-tags":"",placeholder:"请选择APP名称"},model:{value:t.appIds,callback:function(e){t.appIds=e},expression:"appIds"}},t._l(t.appListOptions,function(t){return e("el-option",{key:t.id,attrs:{label:`${t.name} V${t.version}`,value:t.id}})}),1)],1),e("el-form-item",{attrs:{label:"日期范围"}},[e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",editable:!1},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{icon:"el-icon-close"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:function(e){return t.save(t.settingSelected||"custom")}}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"378cec18",null).exports},49145:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return a}});var a=(0,s(51900).Z)({name:"HitokotoWidget",widget:{name:"一言",icon:"note",params:{c:["d","h","i","j","k"],min:0,max:30},w:24,h:1,minW:8,maxW:24,maxH:1,isResizable:!0},inject:["$dashboard"],props:{params:{type:Object,default:()=>({})}},data:()=>({title:"一言",loading:!1,dialogVisible:!1,sentenceType:{a:"动画",b:"漫画",c:"游戏",d:"文学",e:"原创",f:"来自网络",g:"其他",h:"影视",i:"诗词",j:"网易云",k:"哲学",l:"抖机灵"},sentence:{},query:{c:[],min:0,max:30}}),watch:{params:{handler(t){this.query={...t},this.getSentence()},deep:!0}},created(){this.query={...this.params}},mounted(){this.getSentence(),this.$el.addEventListener("contextmenu",t=>{t.preventDefault()})},refresh(){this.getSentence()},setting(){this.dialogVisible=!0},methods:{getSentence(){this.loading=!0,fetch(`https://v1.hitokoto.cn/?c=${this.query.c.join("&c=")}&min_length=${this.query.min}&max_length=${this.query.max}`).then(t=>t.json()).then(t=>{this.loading=!1,this.sentence=t})},copy(){let t=`${this.sentence.hitokoto} \u{2014}\u{2014} ${this.sentence.from} - ${this.sentence.from_who}`;navigator.clipboard.writeText(t).then(()=>{this.$dashboard.notify("已复制到剪切板！")},()=>{console.error("Clipboard write failed!","Your browser does not support clipboard API!")})},search(){window.open(`https://www.baidu.com/s?wd=${this.sentence.hitokoto}`)},sentenceMousedown(t){this.$dashboard.isCollapse&&(0===t.button?this.copy():2===t.button&&this.getSentence())},save(){this.$dashboard.isCollapse||this.$emit("update:params",{...this.query}),this.dialogVisible=!1}}},function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"bg-transparent hitokoto-container",attrs:{shadow:"never","data-is-collapse":t.$dashboard.isCollapse}},[e("div",{staticClass:"hitokoto-body",attrs:{title:"点击左键复制，右键切换"}},[e("div",{staticClass:"hitokoto-operation"},[e("i",{staticClass:"el-icon-document-copy",attrs:{title:"复制"},on:{click:t.copy}}),e("i",{staticClass:"el-icon-refresh",attrs:{title:"切换"},on:{click:t.getSentence}}),e("i",{staticClass:"el-icon-search",attrs:{title:"搜索"},on:{click:t.search}})]),e("span",{staticClass:"hitokoto-text",on:{mousedown:t.sentenceMousedown}},[t._v(t._s(t.sentence.hitokoto))]),e("span",{staticClass:"hitokoto-origin",on:{mousedown:t.sentenceMousedown}},[e("span",{staticClass:"hitokoto-from"},[t._v(t._s(t.sentence.from))]),e("span",{staticClass:"hitokoto-from_who"},[t._v(t._s(t.sentence.from_who))])])]),e("el-dialog",{attrs:{"custom-class":"dialog-setting",visible:t.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"el-dialog__title"},[t._v("配置组件")]),e("small",{staticClass:"text-info"},[t._v(t._s(t.title))])]),e("el-form",{ref:"form"},[e("el-form-item",{attrs:{label:"句子类型"}},[e("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择句子类型"},model:{value:t.query.c,callback:function(e){t.$set(t.query,"c",e)},expression:"query.c"}},t._l(t.sentenceType,function(t,s){return e("el-option",{key:s,attrs:{label:t,value:s}})}),1)],1),e("el-form-item",{attrs:{label:"最小长度"}},[e("el-input-number",{attrs:{min:0,max:t.query.max},model:{value:t.query.min,callback:function(e){t.$set(t.query,"min",e)},expression:"query.min"}})],1),e("el-form-item",{attrs:{label:"最大长度"}},[e("el-input-number",{attrs:{min:t.query.min},model:{value:t.query.max,callback:function(e){t.$set(t.query,"max",e)},expression:"query.max"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{icon:"el-icon-close",size:"small"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-check"},on:{click:t.save}},[t._v("确 定")])],1)],1)],1)},[],!1,null,"6f9fd4fe",null).exports},3120:function(t,e,s){var a={"./example.vue":"48918"};function i(t){return s(o(t))}function o(t){if(!s.o(a,t)){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=o,t.exports=i,i.id=3120},86140:function(t,e,s){var a={"./bar-test-types.vue":"20808","./liquid-activity-rate.vue":"12815"};function i(t){return s(o(t))}function o(t){if(!s.o(a,t)){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=o,t.exports=i,i.id=86140},81067:function(t,e,s){var a={"./hitokoto.vue":"49145"};function i(t){return s(o(t))}function o(t){if(!s.o(a,t)){var e=Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=o,t.exports=i,i.id=81067}}]);